<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Landmælingar Íslands, 2023">
    <meta name="description" content="3D kortasjá fyrir óbyggðarnefnd">
    <!-- License: MIT License -->
    <meta
      name="viewport"
      content="initial-scale=1,maximum-scale=1,user-scalable=no"
    />

    <title>
      Óbyggðarnefnd þrívíddarkort
    </title>
    <link rel="icon" type="image" href="https://www.lmi.is/static/themes/2020/images/logo.svg">

    <link
      rel="stylesheet"
      href="https://js.arcgis.com/4.28/esri/themes/light/main.css"
    />
    <script src="https://js.arcgis.com/4.28/"></script>

    <style>
      html,
      body,
      #viewDiv {
        padding: 0;
        margin: 0;
        height: 100%;
        width: 100%;
      }

      #layerToggle {
        top: 20px;
        right: 20px;
        position: absolute;
        z-index: 99;
        background-color: white;
        border-radius: 8px;
        padding: 10px;
        opacity: 0.75;
      }
    </style>

    <script>
      require(["esri/Map", "esri/views/MapView", "esri/layers/TileLayer", "esri/rest/featureService/FeatureService"], (
        Map,
        MapView,
        TileLayer,
        FeatureService
      ) => {
        /*****************************************************************
         * Create two TileLayer instances. One pointing to a
         * cached map service depicting U.S. male population and the other
         * pointing to a layer of roads and highways.
         *****************************************************************/
        const earthQuakes = new FeatureService({
          url: "https://luk.vedur.is/arcgis/rest/services/skjalftar/skjalftar_isn93/FeatureServer/0",
          // This property can be used to uniquely identify the layer
          id: "earthquakes",
        });
        
        
        const imagery = new Map({
          url: https://services.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer,
          // This property can be used to uniquely identify the layer
          id: "imagery",
        });

        /*const housingLayer = new TileLayer({
          url: "https://tiles.arcgis.com/tiles/nGt4QxSblgDfeJn9/arcgis/rest/services/New_York_Housing_Density/MapServer",
          id: "ny-housing",
          opacity: 0.9
        });*/

        // Add later on
        // https://developers.arcgis.com/javascript/latest/sample-code/scene-blendmode/


        /*****************************************************************
         * Layers may be added to the map in the map's constructor
         *****************************************************************/
        const map = new Map({
          basemap: "imagery",
          layers: [earthQuakes]
        });

        /*****************************************************************
         * Or they may be added to the map using map.add()
         *****************************************************************/
        map.add(earthQuakes);

        const view = new MapView({
          container: "viewDiv",
          map: map
        });

        /*****************************************************************
         * The map handles the layers' data while the view and layer views
         * take care of renderering the layers
         *****************************************************************/
        view.on("layerview-create", (event) => {
          if (event.layer.id === "ny-housing") {
            // Explore the properties of the population layer's layer view here
            console.log(
              "LayerView for male population created!",
              event.layerView
            );
          }
          if (event.layer.id === "streets") {
            // Explore the properties of the transportation layer's layer view here
            // Explore the properties of the transportation layer's layer view here
            console.log("LayerView for streets created!", event.layerView);
          }
        });

        /*****************************************************************
         * Layers are promises that resolve when loaded, or when all their
         * properties may be accessed. Once the population layer has loaded,
         * the view will animate to it's initial extent.
         *****************************************************************/
        view.when(() => {
          housingLayer.when(() => {
            view.goTo(housingLayer.fullExtent).catch((error) => {
              console.error(error);
            });
          });
        });

        const streetsLayerToggle = document.getElementById("streetsLayer");

        /*****************************************************************
         * The visible property on the layer can be used to toggle the
         * layer's visibility in the view. When the visibility is turned off
         * the layer is still part of the map, which means you can access
         * its properties and perform analysis even though it isn't visible.
         *******************************************************************/
        streetsLayerToggle.addEventListener("change", () => {
          transportationLayer.visible = streetsLayerToggle.checked;
        });
      });
    </script>
  </head>

  <body>
    <div id="viewDiv"></div>
    <span id="layerToggle" class="esri-widget">
      <input type="checkbox" id="streetsLayer" /> Transportation
    </span>
  </body>
</html>
